<!-- 
Author       : Alluri Harshitha
Date Updated : 01.05.2020
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Waste Managment System</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<link href="../css/style.css" rel="stylesheet">
</head>
<body>
  <!-- 
    Author       : Ramaguru Radhakrishnan
    Date Updated : 01.05.2020
    -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.2.7/dist/web3.js"></script>
    <script>
        window.onload = function () 
        {
            // check to see if user has metamask addon installed on his browser. check to make sure web3 is defined
            if (typeof web3 ==='undefined') 
            {
                web3 = new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/v3/cbd9dc11b30147e9a2cc974be655ef7c"));
          
            }
        }  
    </script>


    <script>
         web3 = new Web3(new Web3.providers.WebsocketProvider("wss://ropsten.infura.io/ws/v3/cbd9dc11b30147e9a2cc974be655ef7c"));
         console.log("checking");
         var subscription = web3.eth.subscribe('logs', {
             address: '0x2Aad0cB9eB6C39508599E5aD866C18a2d90187Ff',
             topics: ['0xa1cac0c02aaa8455b22f4edad5ea6218aeec41fd73afcf8668f7586accd1f901']
             }, function(error, result){
             console.log("inside if");   
             if (!error)
             {
                console.log(hexToString (result.data));
             }
             else
             {
                console.log(error);
             }
         });
        function hexToString (hex) 
        {
            var string = '';
            for (var i = 128; i < hex.length; i += 2) 
            {
                string += String.fromCharCode(parseInt(hex.substr(i, 2), 16));
            }
            return string.substring(1);
        }
        
        //function to retrieve the last inserted value on the blockchain
        function getValue()
        {
            console.log("Getting the value");

            try 
            {
                // contract Abi defines all the variables,constants and functions of the smart contract. replace with your own abi
                var abi = 
                    [

                    ]
                //contract address. please change the address to your own
                var contractaddress = '0x2A73aeD68cA411F38f34251AD81b4b6C599bb4df';
                //instantiate and connect to contract address via Abi
                var myAbi = web3.eth.contract(abi);
                var myfunction = myAbi.at(contractaddress);
                //call the get function of our SimpleStorage contract
                
                myfunction.retreive.call
                (function (err, id) 
                {
                    if (err) 
                    { 
                        console.log(err)
                    }
                    if (id) 
                    {
                        //display value on the webpage
                    }
                });
            }
            catch (err) 
            {
                document.getElementById("xbalance").innerHTML = err;
            }
        }
    </script>



                          <div class="header">
                          <div class="container">
                          <nav>
                          <h1>Thui-mychain</h1>
                          <label>User-ID:</label>
                          </nav>
                          </div>
                          <div style="float:right;">
                        <form >
                        <button class="btn btn-defaut" formaction="wallet.html"> Wallet</button>
                        
                        </form>
                    </div>
                         </div><br><br><br>


            
    <div class="pickup"><br><br><br>
      <center>
        <form>
      <h2>Next pickup</h2><br>
      <label>Truck-ID:</label>
      <br><br>
      <label>Pick-up Date:</label>
      <br><br>
      <label>Pick-up Time:</label>
      <br><br>
    
      <label>Would you like to drop the waste in next pickup?</label> <br>
      <input type="checkbox" >
       <label for="vehicle1"> Yes</label>&nbsp
       <input type="checkbox">
       <label for="vehicle2"> No</label><br>
       
        <label>On Demand Pickup</label>
      <textarea></textarea><br><br>
     <label>Queries</label>
      <textarea>Any Queries</textarea><br><br>
      <a href="url">Most Frequently asked questions</a>
       <input type="submit" value="Submit"><br><br>
      <br><br>
          </form>
     </center>
    </div>

    <br><br><br><br><br>
       <div class="container">

<table  style="border: 1px solid #ddd;border-collapse: collapse;text-align: left;width: 100%; margin-top:50px;">
  <tr>
   <th>Date</th>
   <th>Plastics</th>
   <th>Metals</th>
   <th>Glass</th>
   <th>Rags</th>
   <th>Inerts</th>
   <th>Biodegrable</th>
   <th>Others</th>
  </tr>
  <tr>
   <td>1-apr-2020</td>
   <td>56%</td>
    <td>93%</td>
    <td>6%</td>
    <td>5%</td>
    <td>13%</td>
    <td>89%</td>
    <td>8%</td>

  </tr>
  <tr>
    <td>3-apr-2020</td>
    <td>23%</td>
    <td>3%</td>
    <td>52%</td>
    <td>87%</td>
    <td>49%</td>
    <td>16%</td>
    <td>66%</td>

  </tr>

</div>    
    
    

                        <div class="footer">
                          <div class="container">Copyright &copy; Thui-mychain</div>        
                        </div>
</body>
</html>